
<div class="appWrapper theme-{{ theme }}">


    <!-- window title bar -->
    <div class="windowTitlebar"></div>


    <!-- Toolbar -->
    <mat-toolbar class="appToolbar">

        <button class="toolbarBtn menuBtn btnHover" (click)="miniNav = !miniNav">
            <!--
            <fa class="sidenavBtnIco" [name]="'bars'" [size]="2" [rotate]="!miniNav ? 90 : 0"></fa>
            -->
            <fa *ngIf="miniNav" class="sidenavBtnIco" [name]="'caret-right'" [size]="3"></fa>
            <fa *ngIf="!miniNav" class="sidenavBtnIco" [name]="'caret-left'" [size]="3"></fa>
        </button>

        <!-- App title -->
        <div class="appTitle ">
        <span class="title">Turntable</span>
        </div>

        <!-- Nav back button -->
        <button (click)="onNavBack()" class="sidenavBtn returnBtn"
        [disabled]="!prevSelectedTab" [class.btnHover]="prevSelectedTab" [class.disabled]="!prevSelectedTab">
        <fa class="sidenavBtnIco" [name]="'angle-left'" [size]="5"></fa>
        </button>

        <!-- Searchbar -->
        <app-search-bar></app-search-bar>
        <div class="flexSpacer"></div>

        <button (click)="isOnPlay = !isOnPlay">playerbar</button>

        <!-- Display playlists type -->
        <div class="displayTypeBtn">
            <mat-button-toggle-group *ngIf="selectedTab === 3" #group="matButtonToggleGroup"
                [ngModel]="displayType" (change)="changeDisplayType($event)">
                <mat-button-toggle value="grid"  checked="displayType.value === 'grid'">
                    <fa [name]="'th'" [size]="1"></fa>
                </mat-button-toggle>
                <mat-button-toggle value="list" checked="displayType.value === 'list'">
                    <fa [name]="'list'" [size]="1"></fa>
                </mat-button-toggle>
            </mat-button-toggle-group>
        </div>


        <div *ngIf="user" class="toolbarBtn userImg">
            <img src="{{ user.img }}" alt="">
            <!--
            <div class="sidenavBtnLabel">{{ user.name }}</div>
            -->
        </div>

        <button [matMenuTriggerFor]="menu" class="toolbarBtn btnHover">
            <fa class="sidenavBtnIco" [name]="'ellipsis-v'" [size]="3"></fa>
        </button>

        <mat-menu #menu="matMenu" yPosition="below" xPosition="after" [overlapTrigger]="false" class="menuBox">
            <button *ngIf="user" (click)="signout()" class="menuItem btnHover">
                <fa class="menuItemIco" [name]="'sign-out'" [size]="2"></fa>
                <span class="menuItemLabel">Sign out</span>
            </button>
            <button *ngIf="!user" (click)="signin()" class="menuItem btnHover">
                <fa class="menuItemIco" [name]="'sign-in'" [size]="2"></fa>
                <span class="menuItemLabel">Sign in</span>
            </button>
            <button (click)="onSelectTab(6)" class="menuItem btnHover">
                <fa class="menuItemIco" [name]="'cog'" [size]="2"></fa>
                <span class="menuItemLabel">Settings</span>
            </button>
        </mat-menu>
    </mat-toolbar>



    <mat-sidenav-container class="appContainer flexSpacer" autosize>

        <!-- Sidenav mini -->
        <mat-sidenav  *ngIf="miniNav" #sidenav [mode]="'side'" opened="true" class="appSidenav miniNav">
            <div class="flexItem sectionLabel"></div>
            <button class="sidenavBtn btnHover" (click)="onSelectTab(1)" [class.activ]="selectedTab === 1 || selectedTab === 2">
                <fa class="sidenavBtnIco" [name]="'home'" [size]="1"></fa>
            </button>
            <button class="sidenavBtn btnHover" (click)="onSelectTab(3)" [class.activ]="selectedTab === 3">
                <fa class="sidenavBtnIco" [name]="'th-list'" [size]="1"></fa>
                <span class="sidenavBtnLabel">Library</span>
            </button>
            <button class="sidenavBtn btnHover" (click)="onSelectTab(5)" [class.activ]="selectedTab === 5">
                <fa class="sidenavBtnIco" [name]="'play-circle'" [size]="1"></fa>
            </button>

            <div class="flexSpacer"></div>

            <button class="sidenavBtn btnHover addBtn" (click)="addPlaylist()">
                <fa class="sidenavBtnIco" [name]="'plus'" [size]="1"></fa>
            </button>
        </mat-sidenav>


        <!-- Sidenav normal -->
        <mat-sidenav *ngIf="!miniNav" #sidenav [mode]="'side'" opened="true" class="appSidenav" [class.miniNav]="miniNav">

            <!--
            <div *ngIf="!miniNav">
            -->
                <!-- Navigation -->
                <div class="flexItem sectionLabel">
                    <span>Navigation</span>
                </div>
                <div class="flexItem">
                    <button class="sidenavBtn btnHover" (click)="onSelectTab(1)" [class.activ]="selectedTab === 1 || selectedTab === 2">
                        <fa class="sidenavBtnIco" [name]="'home'" [size]="1"></fa>
                        <span class="sidenavBtnLabel">Home</span>
                    </button>
                    <button class="sidenavBtn btnHover" (click)="onSelectTab(3)" [class.activ]="selectedTab === 3">
                        <fa class="sidenavBtnIco" [name]="'th-list'" [size]="1"></fa>
                        <span class="sidenavBtnLabel">Library</span>
                    </button>
                    <button class="sidenavBtn btnHover" (click)="onSelectTab(5)" [class.activ]="selectedTab === 5">
                        <fa class="sidenavBtnIco" [name]="'play-circle'" [size]="1"></fa>
                        <span class="sidenavBtnLabel">Player</span>
                    </button>
                </div>

                <!-- Playlists list -->
                <div class="flexItem sectionLabel">
                    <span>Playlists</span>
                    <div class="flexSpacer"></div>
                    <button *ngIf="user" mat-menu-item (click)="refreshYTPlaylists()" [class.rotate]="loading" class="refreshBtn btnHover">
                    <fa class="refreshBtnIco" [name]="'refresh'" [size]="1"></fa>
                    </button>
                </div>
                <div class="flexItem sidenavScroll" #plScrollContainer>
                    <div class="flexItem">

                        <!-- Playlist list item button -->
                        <button class="sidenavBtn btnHover plDrop" *ngFor="let pl of playlistsList"
                            [class.activ]="selectedTab === 4 && pl.id === onSelectPLID"
                            [dragula]="'searchResultsBag'"
                            [attr.data-acceptdrop]="true"
                            [attr.data-hideshadow]="true"
                            [attr.data-plid]="pl.id"
                            (click)="selectPlaylist(pl)">
                            <fa class="sidenavBtnIco" [name]="'folder-open-o'" [size]="1"></fa>
                            <span class="sidenavBtnLabel noOverflow">{{ pl.title }}</span>
                        </button>
                    </div>
                </div>

                <div class="flexSpacer"></div>

                <!-- Add playlist button -->
                <div class="flexItem">
                    <button class="sidenavBtn btnHover addBtn" (click)="addPlaylist()">
                        <fa class="sidenavBtnIco" [name]="'plus'" [size]="1"></fa>
                        <span class="sidenavBtnLabel">Add playlist</span>
                    </button>
                </div>
            <!--
            </div>

            <div *ngIf="miniNav">
                <div class="flexItem sectionLabel"><span></span></div>
                <div class="flexItem">
                    <button class="sidenavBtnMini btnHover" (click)="onSelectTab(1)" [class.activ]="selectedTab === 1 || selectedTab === 2">
                        <fa class="sidenavBtnIcoMini" [name]="'home'" [size]="1"></fa>
                    </button>
                    <button class="sidenavBtnMini btnHover" (click)="onSelectTab(3)" [class.activ]="selectedTab === 3 || selectedTab === 4">
                        <fa class="sidenavBtnIcoMini" [name]="'th-list'" [size]="1"></fa>
                    </button>
                    <button class="sidenavBtnMini btnHover" (click)="onSelectTab(5)" [class.activ]="selectedTab === 5">
                        <fa class="sidenavBtnIcoMini" [name]="'play-circle'" [size]="1"></fa>
                    </button>
                </div>
                <!-- Add playlist button ->
                <div class="flexItem">
                    <button class="sidenavBtnMini btnHover addBtn" (click)="addPlaylist()">
                        <fa class="sidenavBtnIcoMini" [name]="'plus'" [size]="1"></fa>
                    </button>
                </div>
            </div>
        -->

        </mat-sidenav>

        <!-- Content -->
        <mat-sidenav-content class="appContent">

            <div *ngIf="loading" class="appLoader">
                <mat-spinner></mat-spinner>
            </div>

            <!-- Content -->
            <div class="content flexSpacer" [class.withPlayerBar]="isOnPlay">
                <app-home             [hidden]="selectedTab !== 1"></app-home>
                <app-search-results   [hidden]="selectedTab !== 2"></app-search-results>
                <app-library          [hidden]="selectedTab !== 3"></app-library>
                <app-playlist-details [hidden]="selectedTab !== 4"></app-playlist-details>
                <app-player-panel     [hidden]="selectedTab !== 5"></app-player-panel>
                <app-settings         [hidden]="selectedTab !== 6"></app-settings>
            </div>

            <!--
            *ngIf="isOnPlay"
            -->
            <app-player-bar *ngIf="isOnPlay && selectedTab !== 5" class="playerBar" [class.toggleBar]="!isOnPlay"></app-player-bar>

        </mat-sidenav-content>
    </mat-sidenav-container>

</div>
